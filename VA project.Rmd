---
title: "VA project"
---

```{r setup,warning=FALSE,include=FALSE}
library(tidyverse)
ipf_lifts <- read_csv("data/ipf_lifts.csv")
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r}
ipf <- ipf_lifts %>% 
  mutate(year = as.numeric(format(date, '%Y'))) %>% 
  select(-event, -division, -federation, -date) %>% 
  gather(activity, weight, best3squat_kg:best3deadlift_kg) %>% 
  group_by(year)
```

```{r}
max <- ipf %>%
  group_by(sex, activity, year) %>%
  filter(place != "DD" & place != "DQ" & !is.na(weight) & weight == max(weight, na.rm = T),
         year >= 1980) %>% 
  ungroup() %>% 
  group_by (name) %>% 
  mutate(activity = recode(activity, "best3bench_kg" = "Bench", 
  "best3deadlift_kg" = "Deadlift", "best3squat_kg" = "Squat"),
  sex = recode(sex, "F" = "Female", 'M' = "Male")) %>%
  arrange(desc(year))
```

```{r}
competition <- max %>% 
  group_by(sex, name) %>% 
  summarise(n = n()) %>% 
  group_by(sex, n) %>% 
  summarise(total = n())

```

```{r}
#number of max achieved
g_count <- ggplot(competition, aes(x = n, y= total, fill = sex)) +
  geom_bar(stat = "identity")+
  facet_grid(sex ~ .)+
  scale_x_continuous(breaks = seq(0,12,1))+
  scale_y_continuous(breaks = seq(0,50,5))+
  labs(y= "# of participants reaching that max", x = "Number of max achieved", 
       title = "How do the max \nachievements \ndistribute \nacross participants?",
       subtitle = "",
       caption = "")+
  theme(
    strip.text = element_blank(),
    plot.title = element_text(size = 12),
    legend.title = element_blank(),
    legend.position='top',
    legend.background = element_rect(fill = "transparent"),
    legend.box.background = element_rect(fill = "transparent"),
    legend.spacing.x = unit(0.4, 'cm'),
    legend.text = element_text(size = 12),
  )

g_count
```

